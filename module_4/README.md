Project - Авиаперевозки без потерь  
==================================  
 
Автор: Александра Гвоздева  
--------------------------  

**Задание**  

Имеется 8 связанных таблиц (описание см. ниже). Требуется с помощью SQL запросов составить датасет, содержащий информацию о рейсах из Анапы в зимнее время. Далее определить самые малоприбыльные рейсы.  

В наличии имеются следующие таблицы:    
------------------------------------

**Таблица bookings.aircrafts**      

* aircraft_code – код самолета (первичный ключ)
* model – модель самолета
* range – максимальная дальность полета, км

**Таблица bookings.airports**

* airport_code – код аэропорта (первичный ключ)
* airport_name – название аэропорта
* city – город, в котором расположен аэропорт
* coordinates – координаты аэропорта (широта и долгота)
* timezone – часовой пояс аэропорта

**Таблица bookings.boarding_passes**

* ticket_no – номер билета (первичный ключ)
* flight_id – идентификатор рейса (внешний ключ)
* boarding_no – номер посадочного талона
* seat_no – номер места

**Таблица bookings.bookings**

* book_ref – номер бронирования (первичный ключ)
* book_date – дата бронирования
* total_amount – полная сумма бронирования

**Таблица bookings.flights**

* flight_id – идентификатор рейса (первичный ключ)
* flight_no – номер рейса
* scheduled_departure – время вылета по расписанию
* scheduled_arrival – время прибытия по расписанию
* departure_airport – аэропорт отправления
* arrival_airport – аэропорт прибытия
* status – статус рейса
* aircraft_code – код самолета (внешний ключ)
* actual_departure – фактическое время вылета
* actual_arrival – фактическое время прибытия

**Таблица bookings.seats**

* aircraft_code – код самолета (первичный ключ)
* seat_no – номер места
* fare_conditions – класс обслуживания

**Таблица bookings.ticket_flights**

* ticket_no – номер билета (первичный ключ)
* flight_id – идентификатор рейса (внешний ключ)
* fare_conditions – класс обслуживания
* amount – стоимость перелета

**Таблица bookings.tickets**

* ticket_no – номер билета (первичный ключ)
* book_ref – номер бронирования (внешний ключ)
* passenger_id – идентификатор пассажира (номер паспорта)
* passenger_name – имя пассажира
* contact_data – контактные данные пассажира


В ходе работы над проектом:  
---------------------------  

* Был составлен SQL запрос к базе данных с использованием агрегатных функций, оконных функций и подзапросов (см. файл "Запрос SQL к основному заданию.txt")
* Сформирован датасет, содержащий требуемые данные (см. файл "query_result_5.csv")
* Датасет проанализирован при помощи библиотеки pandas, найдены наименее прибыльные рейсы
* Составлена презентация в PowerPoint, содержащая основные результаты проекта (см. файл "Проект 4, Гвоздева А.pptx")    

Выводы:  
-------
* Был получен датасет, включающий 127 записей о рейсах из Анапы в зимнее время года. Датасет содержат пропуски, связанные с использованием LEFT JOIN. Пропуски были удалены, т.к. никакой полезной информации извлечь из них не получится.
* Для полноценного анализа данных не хватает информации о расходах на каждый рейс. Была предложена формула, с помощью которой эти расходы можно посчитать. Необходимо привлекать данные из сторонних источников для проведения расчета. Расчет реализован в дополнительном задании к данному проекту.
* Анализ данных показал, что было совершено равное количество рейсов в Москву и Белгород (59). Прибыльность рейсов в Москву в среднем выше прибыльности рейсов в Белгород. Заполняемость рейсов в Белгород при этом несколько выше заполняемости рейсов в Москву.
* Были найдены 4 рейса с заполняемостью ниже 75% (2 в Москву и 2 в Белгород). Эти и есть наименее прибыльные рейсы.

